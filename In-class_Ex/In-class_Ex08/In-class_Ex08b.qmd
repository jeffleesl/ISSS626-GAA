---
title: "In-class Exercise 8: Supplement to Hands-on Exercise 8"
author: "Jeffrey Lee Shao Lin"
date: "Oct 31 2024"
date-modified: "last-modified"
execute: 
  eval: true
  echo: true
  freeze: true  #will not re-render all items
  message: false #no warning messages go out
---

# 1. Getting Started

## 1.1 Installing and Loading R packages

```{r}
pacman::p_load(sf, spdep, GWmodel, SpatialML, 
               tmap, rsample, Metrics, tidyverse,
               knitr, kableExtra)
```

# 2. Preparing Data

::: panel-tabset

## Data import

```{r}
mdata <- read_rds("data/mdata.rds")
```

## Data Sampling 

Calibrating predictive models are computational intensive, especially random forest method is used. For quick prototyping, a 10% sample will be selected at random from the data by using the code chunk below.

```{r}
set.seed(1234)
HDB_sample <- mdata %>%
  sample_n(1500)
```

## Checking of overlapping point

::: {.callout-warning}
When using GWmodel to calibrate explanatory or predictive models, it is very important to ensure that there are no overlapping point features
:::

The code chunk below is used to check if there are overlapping point features.

```{r}
overlapping_points <- HDB_sample %>%
  mutate(overlap = lengths(st_equals(., .)) > 1)
```

## Spatial jitter

In the code code chunk below, st_jitter() of sf package is used to move the point features by 5m to avoid overlapping point features.

```{r}
HDB_sample <- HDB_sample %>%
  st_jitter(amount = 5)
```

:::